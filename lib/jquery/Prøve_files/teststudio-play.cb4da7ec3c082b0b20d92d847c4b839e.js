require({cache:{"teststudio/play/model/Test":function(){define(["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/array"],function(h,k,d){return h("teststudio.play.model.Test",null,{id:null,isLoaded:!1,constructor:function(g){"undefined"===typeof g&&(g={});h.safeMixin(this,g);null!==this.id&&(this.id=parseInt(this.id,10))}})})},"teststudio/play/model/Question":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/_base/xhr dojo/json teststudio/play/model/QuestionStore teststudio/play/model/QuestionReply dojo/_base/array".split(" "),function(h,k,d,g,l,q,a){return h("teststudio.play.model.Question",null,{store:null,constructor:function(a){"undefined"===typeof a&&(a={});this.store=new l({});h.safeMixin(this,a);"undefined"!==typeof this.id&&(this.id=parseInt(this.id,10))},load:function(){var a=new k,b=this;return this.isLoaded?this:!this.id||isNaN(this.id)?(a.errback(Error("Cannot load, invalid ID")),a):this.store.get(this.id).then(function(a){h.safeMixin(b,a);b.isLoaded=!0;b._populateHasReply();return b})},getReply:function(){var a=new k,b=this,f=b.id;if(!f||isNaN(f)||1>f)return a.errback(Error("Cannot load the reply, invalid id")),a;f=parseInt(f,10);"undefined"!==typeof b.replyCache&&b.replyCache.isLoaded?a.resolve(b.replyCache):(f=new q({questionId:f}),f.load().then(function(f){b.replyCache=f;a.resolve(b.replyCache)}));return a},_populateHasReply:function(){"undefined"!==typeof matchReplyList&&("object"===typeof matchReplyList[this.id]&&matchReplyList[this.id].submittedAnswerList)&&(this.hasReply=!0)}})})},"teststudio/play/model/QuestionStore":function(){define(["dojo/_base/declare","dojo/store/JsonRest","dojo/_base/xhr","dojo/json"],function(h,k,d,g){return h("teststudio.play.model.QuestionStore",k,{target:null,idProperty:"id",accepts:"application/vnd.fronter+json; version\x3d1.0",constructor:function(g){var d=this;require(["teststudio/play/view/CurrentTest"],function(a){var e;void 0!==typeof sessionStorage&&(e=sessionStorage.getItem("itemCustomerUrl"));e||(e=Fronter.Util.getCustomerUrl());d.target=e+"/app/teststudio/play/tests/"+a.id+"/questions/";h.safeMixin(d,g)})}})})},"teststudio/play/model/QuestionReply":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/_base/xhr dojo/json teststudio/play/model/QuestionReplyStore dojo/_base/array".split(" "),function(h,k,d,g,l,q){return h("teststudio.play.model.QuestionReply",null,{store:null,constructor:function(a){"undefined"===typeof a&&(a={});this.store=new l({});h.safeMixin(this,a);"undefined"!==typeof this.id&&(this.id=parseInt(this.id,10));"undefined"!==typeof this.questionId&&(this.questionId=parseInt(this.questionId,10))},load:function(){var a=new k,e=this;return this.isLoaded?this:!this.questionId||isNaN(this.questionId)?(a.errback(Error("Cannot load, invalid question ID")),a):this.store.get(this.questionId).then(function(a){h.safeMixin(e,a);e.isLoaded=!0;return e})}})})},"teststudio/play/model/QuestionReplyStore":function(){define(["dojo/_base/declare","dojo/_base/Deferred"],function(h,k){return h("teststudio.play.model.QuestionReplyStore",null,{target:null,idProperty:"id",constructor:function(d){"undefined"!==typeof matchReplyList&&(this.target=matchReplyList);h.safeMixin(this,d)},get:function(d){var g=new k;if(null!==this.target&&"object"===typeof this.target[d]&&this.target[d].submittedAnswerList)return g.resolve(this.target[d]),g;g.errback(Error("Reply not found"));return g}})})},"teststudio/play/util/i18n/translation":function(){define([],function(){var h=[];Fronter.I18n.translate("QT_CLEAR_ALL_MATCHES SCORE QT_SCORE_OUT_OF QT_SHOW_CORRECT_MATCHES QT_SHOW_MY_MATCHES QT_HEADER_QUESTION_TOTAL_SCORE QT_HEADER_QUESTION_SUBMITTED_ANSWER QT_X_MATCHED_WITH_Y QT_X_MATCHED_WITH_Y_CORRECT QT_X_MATCHED_WITH_Y_NOT_CORRECT QT_X_NOT_MATCHED QT_HEADER_QUESTION_CORRECT_ANSWER QT_X_SHOULD_BE_MATCHED_WITH_Y QT_LEAVING_YOU_STILL_HAVE_X_ITEMS_TO_MATCH QT_ALL_ITEMS_MATCHED QT_ALL_MATCHES_WERE_CLEARED QT_MATCH_HELP_TEXT QT_MATCH_HELP_LINK_TEXT QT_LAST_ITEM_STILL_ON_X QT_FIRST_ITEM_STILL_ON_X QT_X_NOW_FOCUSED QT_X_NOW_FOCUSED_ALREADY_MATCHED_TO_Y QT_ALREADY_ON_X_COLUMN_STILL_ON_Y QT_X_HAS_BEEN_UNSELECTED QT_UNSELECTED_X QT_UNSELECTED_X_SELECTED_Y QT_MATCHED_X_WITH_Y QT_SELECTED_X QT_SELECTED_X_ALREADY_MATCHED_TO_Y QT_COMMA_X_NOW_FOCUSED CLOSE".split(" "),function(k){h=k;for(var d in k)i18n_add(d,k[d])},!0);return{get:function(k){return h[k]}}})},"teststudio/play/view/CurrentTest":function(){define(["teststudio/play/model/Test","dojo/_base/declare","dojo/_base/xhr"],function(h,k,d){var g=new h({id:parseInt(testId,10)});d.get({url:Fronter.Util.Config.get("customerUrl")+"/app/teststudio/play/tests/"+g.id,headers:{Accept:"application/vnd.fronter+json; version\x3d1.0"},preventCache:!0,handleAs:"json",sync:!0,load:function(d){k.safeMixin(g,d);g.isLoaded=!0}});return g})},"teststudio/play/widget/QuestionWidgetInstantiator":function(){define(["dojo/_base/declare","teststudio/play/model/Question","dojo/query","dojo/_base/Deferred","teststudio/play/widget/Match"],function(h,k,d,g,l){return h("teststudio.play.widget.QuestionWidgetInstantiator",null,{questionId:null,questionWidget:null,questionObj:null,questionTypeId:null,widgetModel:null,ajaxedTypes:{9:l},constructor:function(g){h.safeMixin(this,g);this.widgetModel=this._getWidgetModel()},instantiate:function(){var d=this,a=new g;new g;(new k({id:this.questionId})).load().then(function(e){d.questionObj=e;e.hasReply?e.getReply().then(function(b){d._makeWidget(b);a.resolve(d.questionWidget)}):(d._makeWidget(null),a.resolve(d.questionWidget))});return a},_makeWidget:function(g){var a=d("#play-question"+this.questionId)[0];this.questionWidget=new this.widgetModel({questionObj:this.questionObj,replyObj:g});this.questionWidget.placeAt(a);this.questionWidget.startup()},_getWidgetModel:function(){if(this.questionTypeId in
this.ajaxedTypes)return this.ajaxedTypes[this.questionTypeId];throw"Invalid question type.";}})})},"teststudio/play/widget/Match":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojox/gfx dojo/query dojo/dom dojo/dom-construct dojo/dom-class dojo/on dojo/dom-style dojo/dom-attr dojo/dom-geometry dojo/json shared/underscore dojo/keys teststudio/play/widget/MatchTextFeedback teststudio/play/util/i18n/translation dojo/text!./Match.mustache.html dojo/text!./MatchCorrectAnswers.mustache.html teststudio/play/widget/MatchKeystrokeHandler dojo/NodeList-traverse dojo/NodeList-dom".split(" "),function(h,k,d,g,l,q,a,e,b,f,r,n,v,s,t,m,u,x,p,y,z,A){return k("teststudio.play.widget.Match",[g,l],{templateString:null,questionObj:null,baseClass:"match-question",selectedLeft:null,selectedRight:null,leftNodeList:null,rightNodeList:null,maxItemCount:null,matches:null,surface:null,clearButton:null,correctMatchesLink:null,replyMatchesLink:null,displayStudentResult:!1,replyMatchesNode:null,correctMatchesNode:null,matchingStatusNode:null,questionStateInput:null,screenReaderHelpContainer:null,replyObj:null,keystrokeHandler:null,helpLink:null,constructor:function(){this.keystrokeHandler=new A(this)},postMixInProperties:function(){this.questionObj.hasReply&&!m.isNull(this.replyObj)?d.isObject(this.replyObj.questionState.state)&&"OK"===this.replyObj.questionState.status?(this.questionObj.matchItemList1=this.sortMatchItemList(this.questionObj.matchItemList1,this.replyObj.questionState.state.matchItemList1),this.questionObj.matchItemList2=this.sortMatchItemList(this.questionObj.matchItemList2,this.replyObj.questionState.state.matchItemList2)):this.questionObj.random&&this.randomizeMatchItemLists():this.questionObj.random&&this.randomizeMatchItemLists();this.prepareTemplate()},randomizeMatchItemLists:function(){this.questionObj.matchItemList1.sort(function(){return 0.5-Math.random()});this.questionObj.matchItemList2.sort(function(){return 0.5-Math.random()})},prepareTemplate:function(){var c=this,a,b={};for(a=0;a<this.questionObj.matchItemList1.length;a++)this.questionObj.matchItemList1[a].index=a;for(a=0;a<this.questionObj.matchItemList2.length;a++)this.questionObj.matchItemList2[a].index=a;require(["teststudio/play/view/CurrentTest"],function(a){c.displayStudentResult=a.displayStudentResult});b.question=this.questionObj;b.strings={helpText:p.get("QT_MATCH_HELP_TEXT"),helpLink:p.get("QT_MATCH_HELP_LINK_TEXT"),close:p.get("CLOSE"),questionMarkUrl:Fronter.Util.Config.get("customerUrl")+"/design_images/default/other_images/question_mark.png"};this.templateString=Mustache.to_html(y,b)},sortMatchItemList:function(c,a){var b=Array(a.length),f,e,d;for(f=0;f<a.length;f++){d={};for(e=0;e<c.length;e++)if(c[e].id==a[f]){d.id=c[e].id;d.text=c[e].text;b[f]=d;break}}return b},startup:function(){var c,b;this.inherited(arguments);this.leftNodeList=a(".left-match-items .match-item",this.replyMatchesNode);this.rightNodeList=a(".right-match-items .match-item:first-child",this.replyMatchesNode);b={state:{matchItemList1:[],matchItemList2:[]}};for(c=0;c<this.questionObj.matchItemList1.length;c++)b.state.matchItemList1[c]=this.questionObj.matchItemList1[c].id;for(c=0;c<this.questionObj.matchItemList2.length;c++)b.state.matchItemList2[c]=this.questionObj.matchItemList2[c].id;this.questionStateInput.value=t.stringify(b);this.hiddenInputs=[];for(c=0;c<this.leftNodeList.length;c++)this.hiddenInputs[c]=a("input",this.leftNodeList[c])[0];this.maxItemCount=Math.max(this.leftNodeList.length,this.rightNodeList.length);this.matches=Array(this.maxItemCount);this.surface=q.createSurface(this.canvasNode,100,n.get(this.domNode,"height"));this.questionObj.hasReply&&!m.isNull(this.replyObj)?this.replyObj.isEditable?(this.showPreviousReply(),this.enablePlayMode()):(this.displayStudentResult||this.replyObj.correctAnswerList?(this.createScoreSummarySection(),this.showPreviousReply(),this.createIndividualMatchFeedbackIndicators()):this.showPreviousReply(),new x({replyObj:this.replyObj,matchItemList1:this.questionObj.matchItemList1,matchItemList2:this.questionObj.matchItemList2,displayStudentResult:this.displayStudentResult},this.textFeedbackPlaceholderNode)):this.enablePlayMode()},enablePlayMode:function(){this.bindClickEvents();this.bindKeyPressEvents();this.createClearButton();this.bindHelpLink();this.bindTabInEvents();f.add(this.replyMatchesNode,"playing");f.remove(this.screenReaderHelpContainer,"hidden")},createClearButton:function(){var c=this;this.clearButton=b.create("button",{className:"reset cancel",type:"button",innerHTML:p.get("QT_CLEAR_ALL_MATCHES")},a(".questions .wrapper",this.domNode)[0],"after");a(this.clearButton).on("click",function(a){a.preventDefault();a.stopPropagation();c.clearAllMatches();c.checkRemainingMatches()})},bindHelpLink:function(){var c=this;r(this.helpLink,"click",function(a){a.preventDefault();c.toggleHelpLink(!1);c.toggleHelpDiv(!0)});r(this.closeHelpNode,"click",function(a){a.preventDefault();c.toggleHelpLink(!0);c.toggleHelpDiv(!1)})},createIndividualMatchFeedbackIndicators:function(){var c=[],w=[],f,e,d,g=0;if(this.replyObj.submittedAnswerList&&this.replyObj.correctAnswerList){h.forEach(this.replyObj.submittedAnswerList,function(c){w[c.matchItem2]=c});this.replyObj.correctAnswerList&&h.forEach(this.replyObj.correctAnswerList,function(a){c[a.matchItem2]=a.score});for(g=0;g<this.rightNodeList.length;g++)e=this.rightNodeList[g].getAttribute("data-item-id"),d=w[e],m.isUndefined(d)||(m.isUndefined(d.isCorrect)||(f="wrong-answer",d.isCorrect&&(f="correct-answer"),f=b.create("li",{className:"correctness-indicator "+f},this.rightNodeList[g],"after")),m.isUndefined(d.score)||b.create("li",{className:"score-obtained",innerHTML:"["+parseFloat(d.score).toFixed(2)+"]"},f,"after")),b.create("li",{className:"match-max-score",innerHTML:"["+parseFloat(c[e]).toFixed(2)+"]"},a(".right-match-items .match-item:first-child",this.correctMatchesNode)[g],"after")}},createScoreSummarySection:function(){var c=null,f="";if(this.displayStudentResult||this.replyObj.correctAnswerList)c=b.create("div",{className:"question-feedback","aria-hidden":"true"},a(".wrapper",this.domNode)[0],"last"),this.displayStudentResult&&(f=p.get("SCORE")+': \x3cspan class\x3d"total-score"\x3e'+this.replyObj.score+"\x3c/span\x3e ("+p.get("QT_SCORE_OUT_OF")+' \x3cspan class\x3d"max-score"\x3e'+this.replyObj.maxScore+"\x3c/span\x3e)",b.create("p",{className:"score-summary",innerHTML:f},c,"last"))},clearAllMatches:function(){var c;this.unselect();this.surface.clear();for(c=0;c<this.leftNodeList.length;c++)this.removeColorClasses(this.leftNodeList[c]);for(c=0;c<this.rightNodeList.length;c++)this.removeColorClasses(this.rightNodeList[c]);for(c=0;c<this.hiddenInputs.length;c++)this.hiddenInputs[c].value="";this.matches=Array(this.maxItemCount);this.setLiveRegionMessage(p.get("QT_ALL_MATCHES_WERE_CLEARED"))},drawMatch:function(c,a,b,f){var e=s.position(c,!0);a=s.position(a,!0);e=Math.floor(e.y-f.y+e.h/2);a=Math.floor(a.y-f.y+a.h/2);b.createPath().moveTo(0,e).hLineTo(5).curveTo(2*f.w/3,e,f.w/3,a,f.w-5,a).hLineTo(f.w).setStroke({width:3,color:this.getLineColor(c)})},redraw:function(){var c,a,b=null;this.surface.clear();this.matches.length&&(b=s.position(this.surface._parent,!0));for(c=0;c<this.matches.length;c++)null!=this.matches[c]&&(a=this.matches[c],this.drawMatch(this.leftNodeList[c],this.rightNodeList[a],this.surface,b))},drawCorrectMatches:function(){var c,b=a(".left-match-items .match-item",this.correctMatchesNode),f=a(".right-match-items .match-item",this.correctMatchesNode),e,d=null,g=null,d=this.getCorrectMatches();d.length&&(g=s.position(this.correctSurface._parent,!0));this.correctSurface.clear();for(c=0;c<d.length;c++)null!=d[c]&&(e=d[c],this.drawMatch(b[c],f[e],this.correctSurface,g))},storeMatch:function(c,a){var b=null,e;for(e=0;e<this.matches.length;e++)if(this.matches[e]===a){b=e;break}m.isNull(b)||(this.matches[b]=null,this.removeColorClasses(this.leftNodeList[b]),this.hiddenInputs[b].value="");null!=this.matches[c]&&this.removeColorClasses(this.rightNodeList[this.matches[c]]);this.matches[c]=a;this.hiddenInputs[c].value=this.rightNodeList[a].getAttribute("data-item-id");this.removeColorClasses(this.leftNodeList[c]);this.removeColorClasses(this.rightNodeList[a]);f.add(this.leftNodeList[c],this.getColorClass(c));f.add(this.rightNodeList[a],this.getColorClass(c))},showRightAndWrong:function(){var c=null,b=null,f=[],e=null,d=0;if(this.replyObj.correctAnswerList){this.setupCorrectMatches();h.forEach(this.replyObj.correctAnswerList,function(c){f[c.matchItem1]=c});for(d=0;d<this.rightNodeList.length;d++)this.removeColorClasses(this.leftNodeList[d]),this.removeColorClasses(this.rightNodeList[d]),c=h.indexOf(this.matches,d),e="wrong-answer",-1!=c&&(b=this.leftNodeList[c].getAttribute("data-item-id"),f[b].matchItem2===this.rightNodeList[d].getAttribute("data-item-id")&&(e="correct-answer"),a(this.leftNodeList[c]).addClass(e),a(this.rightNodeList[d]).addClass(e))}},showPreviousReply:function(){for(var c=null,a=null,b=c=null,f=null,d=0,d=0;d<this.replyObj.submittedAnswerList.length;d++)c=this.replyObj.submittedAnswerList[d],a=e.byId(c.matchItem1),c=e.byId(c.matchItem2),!m.isNull(a)&&!m.isNull(c)&&(b=this.leftNodeList.indexOf(a),f=this.rightNodeList.indexOf(c)),!m.isNull(b)&&!m.isNull(f)&&this.storeMatch(b,f);this.showRightAndWrong();this.redraw()},setupCorrectMatches:function(){var c=null,e=null,d=0;this.correctMatchesNode=b.create("div",{className:"correct-matches",innerHTML:Mustache.to_html(z,this.questionObj)},this.replyMatchesNode,"after");c=a(".left-match-items .match-item",this.correctMatchesNode);e=a(".right-match-items .match-item",this.correctMatchesNode);for(d=0;d<c.length;d++)f.add(c[d],"correct-answer");for(d=0;d<e.length;d++)f.add(e[d],"correct-answer");this.correctSurface=q.createSurface(a(".canvasSurface",this.correctMatchesNode)[0],100,n.get(this.replyMatchesNode,"height"));this.drawCorrectMatches();n.set(this.correctMatchesNode,"display","none");this.setupTogglingBetweenRepliesAndCorrectMatches()},getCorrectMatches:function(){for(var c=null,a=null,b=null,f=null,d=c=null,g=0,d=Array(this.maxItemCount),g=0;g<this.replyObj.correctAnswerList.length;g++)c=this.replyObj.correctAnswerList[g],f=e.byId(c.matchItem1),c=e.byId(c.matchItem2),!m.isNull(f)&&!m.isNull(c)&&(a=this.leftNodeList.indexOf(f),b=this.rightNodeList.indexOf(c)),!m.isNull(a)&&!m.isNull(b)&&(d[a]=b);return d},setupTogglingBetweenRepliesAndCorrectMatches:function(){var c=this;this.correctMatchesLink=b.create("a",{href:"#",className:"correct-matches-link",innerHTML:p.get("QT_SHOW_CORRECT_MATCHES")},a(".question-feedback",this.domNode)[0],"last");r(this.correctMatchesLink,"click",function(a){a.preventDefault();a.stopPropagation();c.toggleView(!0)});this.replyMatchesLink=b.create("a",{href:"#",className:"reply-matches-link",innerHTML:p.get("QT_SHOW_MY_MATCHES")},a(".question-feedback",this.domNode)[0],"last");r(this.replyMatchesLink,"click",function(a){a.preventDefault();a.stopPropagation();c.toggleView(!1)})},toggleView:function(c){c?(n.set(this.replyMatchesNode,"display","none"),n.set(this.correctMatchesNode,"display","block"),n.set(this.replyMatchesLink,"display","inline"),n.set(this.correctMatchesLink,"display","none")):(n.set(this.replyMatchesNode,"display","block"),n.set(this.correctMatchesNode,"display","none"),n.set(this.replyMatchesLink,"display","none"),n.set(this.correctMatchesLink,"display","inline"))},handleSelection:function(c){f.contains(c,"selected")?this.unselect():(a("li",this.replyMatchesNode).removeClass("selected").removeClass("focused"),f.add(c,"selected"),f.add(c,"focused"),"left"===c.parentNode.getAttribute("data-list-position")?this.selectedLeft=c.getAttribute("data-item-index"):this.selectedRight=c.getAttribute("data-item-index"),!m.isNull(this.selectedLeft)&&!m.isNull(this.selectedRight)&&(this.storeMatch(this.selectedLeft,this.selectedRight),this.unselect(),this.redraw(),this.checkRemainingMatches()))},bindClickEvents:function(){var c=this;a("li",c.replyMatchesNode).on("click",function(a){c.keystrokeHandler.handleAction(a.target)})},bindKeyPressEvents:function(){var c=this;a(this.replyMatchesNode).on("keydown",function(a){c.keystrokeHandler.captureKeystroke(a)})},bindTabInEvents:function(){var c=this;r(this.helpLink,"keydown",function(a){"none"===n.get(c.helpNode,"display")&&a.keyCode===u.TAB&&!a.shiftKey&&c.keystrokeHandler.moveFocusUpOrDown(c.helpLink,"down",!0)});r(this.closeHelpNode,"keydown",function(a){a.keyCode===u.TAB&&!a.shiftKey&&c.keystrokeHandler.moveFocusUpOrDown(c.helpLink,"down",!0)});r(this.clearButton,"keydown",function(a){a.keyCode===u.TAB&&a.shiftKey&&c.keystrokeHandler.moveFocusUpOrDown(c.helpLink,"down",!0)});r(this.replyMatchesNode,"blur",function(a){c.clearFocus()})},removeColorClasses:function(a){var b=v.get(a,"class").split(" "),e;for(e=0;e<b.length;e++)0===b[e].indexOf("color")&&f.remove(a,b[e])},unselect:function(){this.selectedRight=this.selectedLeft=null;a(".questions li",this.domNode).removeClass("selected")},getLineColor:function(a){return n.get(a,"borderBottomColor")},getColorClass:function(a){return"color"+a%8},getSelectedItemNode:function(){var c=a(".match-item.selected",this.domNode);return 0===c.length?null:c[0]},getNodeListPosition:function(a){return a==this.getRightNodeList()?"right":a==this.getLeftNodeList()?"left":null},toggleHelpDiv:function(a){a?n.set(this.helpNode,"display","block"):n.set(this.helpNode,"display","none")},toggleHelpLink:function(a){a?n.set(this.helpLink,"display","block"):n.set(this.helpLink,"display","none")},setQuestionStatusMessage:function(a,b){v.set(this.matchingStatusNode,"tabindex",a);this.matchingStatusNode.innerHTML=b},setLiveRegionMessage:function(a){this.logNode.innerHTML=a},getMatchedItemNode:function(a){var b=this.getNodeListForItemNode(a);a=b.indexOf(a);b=this.getNodeListPosition(b);return"left"===b?m.isString(this.matches[a])?this.rightNodeList[this.matches[a]]:null:"right"===b?0<=h.indexOf(this.matches,a.toString())?this.leftNodeList[h.indexOf(this.matches,a.toString())]:null:null},checkRemainingMatches:function(){var c=a(".left-match-items .match-item",this.domNode),b=0,e;for(e=0;e<c.length;e++)m.isNull(this.getMatchedItemNode(c[e]))&&b++;0<b?this.setQuestionStatusMessage(0,m.sprintf(p.get("QT_LEAVING_YOU_STILL_HAVE_X_ITEMS_TO_MATCH"),{X:b})):this.setQuestionStatusMessage(0,p.get("QT_ALL_ITEMS_MATCHED"))},getLeftNodeList:function(){return this.leftNodeList},getRightNodeList:function(){return this.rightNodeList},getOtherNodeList:function(a){return a==this.getRightNodeList()?this.getLeftNodeList():a==this.getLeftNodeList()?this.getRightNodeList():null},getNodeListForItemNode:function(a){return-1!==this.leftNodeList.indexOf(a)?this.leftNodeList:-1!==this.rightNodeList.indexOf(a)?this.rightNodeList:null},getFocusedItemNode:function(){var b=a(".match-item.focused",this.replyMatchesNode);return 0===b.length?null:b[0]},moveFocus:function(a){this.clearFocus();this.setFocus(a)},clearFocus:function(a){this.getLeftNodeList().removeClass("focused");this.getRightNodeList().removeClass("focused")},setFocus:function(a){f.add(a,"focused")}})})},"teststudio/play/widget/MatchTextFeedback":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/array teststudio/play/util/i18n/translation shared/underscore dojo/text!./MatchTextFeedback.mustache.html".split(" "),function(h,k,d,g,l,q,a){return h("teststudio.play.widget.MatchTextFeedback",[k,d],{templateString:null,baseClass:"match-text-feedback",templateData:null,matchItemList1:null,matchItemList2:null,displayStudentResult:null,replyObj:null,constructor:function(a){h.safeMixin(this,a)},postMixInProperties:function(){this.setupMatchItemListsForLookup();this.renderTemplate()},setupMatchItemListsForLookup:function(){var a=this.matchItemList1,b=this;g.forEach(a,function(a){b.matchItemList1[a.id]=a.text});a=this.matchItemList2;g.forEach(a,function(a){b.matchItemList2[a.id]=a.text})},renderTemplate:function(){var e={myscore:this.replyObj.score,totalscore:this.replyObj.maxScore,outof:l.get("QT_SCORE_OUT_OF"),headeryourscore:l.get("QT_HEADER_QUESTION_TOTAL_SCORE"),headeryouranswers:l.get("QT_HEADER_QUESTION_SUBMITTED_ANSWER"),headercorrectanswers:l.get("QT_HEADER_QUESTION_CORRECT_ANSWER"),matches:this.createSubmittedMatchesData(),correctmatches:this.createCorrectMatchesData(),displaystudentresult:this.displayStudentResult,displaycorrectanswers:this.replyObj.correctAnswerList?!0:!1};this.templateString=Mustache.to_html(a,e)},createSubmittedMatchesData:function(){for(var a=[],b="",f="",d=null,b=null,g=l.get("QT_X_MATCHED_WITH_Y"),h=l.get("QT_X_MATCHED_WITH_Y_CORRECT"),k=l.get("QT_X_MATCHED_WITH_Y_NOT_CORRECT"),t=l.get("QT_X_NOT_MATCHED"),f=null,d=0;d<this.matchItemList1.length;d+=1)b=this.findSubmittedMatchForLeftItem(this.matchItemList1[d].id),null===b?f=q.sprintf(t,{X:this.matchItemList1[d].text}):(f=g,this.replyObj.correctAnswerList&&(f=b.isCorrect?h:k),f=q.sprintf(f,{X:this.matchItemList1[d].text,Y:this.matchItemList2[b.matchItem2]}),"undefined"!==typeof b.score&&(f+=" "+l.get("SCORE")+": "+parseFloat(b.score).toFixed(2))),b={matchresulttext:f},a.push(b);return a},createCorrectMatchesData:function(){var a=[],b=null,d=null,g=null,b=d=null,h=l.get("QT_X_SHOULD_BE_MATCHED_WITH_Y");if(this.replyObj.correctAnswerList)for(g=0;g<this.matchItemList1.length;g+=1)d=this.matchItemList1[g].id,b=this.findCorrectMatchForLeftItem(this.matchItemList1[g].id),d=q.sprintf(h,{X:this.matchItemList1[d],Y:this.matchItemList2[b.matchItem2]}),"undefined"!==typeof b.score&&(d+=" "+l.get("SCORE")+": "+b.score),b={correctmatchtext:d},a.push(b);return a},findCorrectMatchForLeftItem:function(a){var b;if(this.replyObj.correctAnswerList)for(b=0;b<this.replyObj.correctAnswerList.length;b+=1)if(this.replyObj.correctAnswerList[b].matchItem1===a)return this.replyObj.correctAnswerList[b];return null},findSubmittedMatchForLeftItem:function(a){var b;for(b=0;b<this.replyObj.submittedAnswerList.length;b+=1)if(this.replyObj.submittedAnswerList[b].matchItem1===a)return this.replyObj.submittedAnswerList[b];return null}})})},"teststudio/play/widget/MatchKeystrokeHandler":function(){define("dojo/_base/declare dojo/keys teststudio/play/util/i18n/translation shared/underscore dojo/dom-attr dojo/dom-class dojo/NodeList-dom".split(" "),function(h,k,d,g,l,q){return h(null,{matchWidget:null,keystrokeFunctions:{},constructor:function(a){this.matchWidget=a;this.keystrokeFunctions[k.UP_ARROW]=this.handleUpArrow;this.keystrokeFunctions[k.DOWN_ARROW]=this.handleDownArrow;this.keystrokeFunctions[k.LEFT_ARROW]=this.handleLeftArrow;this.keystrokeFunctions[k.RIGHT_ARROW]=this.handleRightArrow;this.keystrokeFunctions[k.ESCAPE]=this.handleEscape;this.keystrokeFunctions[k.SPACE]=this.handleSpace},captureKeystroke:function(a){a.keyCode&&this.canHandleKeystroke(a.keyCode)&&(a.preventDefault(),this.handleKeystroke(a.keyCode,a))},canHandleKeystroke:function(a){return this.keystrokeFunctions.hasOwnProperty(a)},handleKeystroke:function(a,d){var b=this.matchWidget.getFocusedItemNode();null===b&&(b=d.target);return this.canHandleKeystroke(a)?this.keystrokeFunctions[a].apply(this,[b]):!1},handleUpArrow:function(a){return this.moveFocusUpOrDown(a,"up",!1)},handleDownArrow:function(a){return this.moveFocusUpOrDown(a,"down",a===this.matchWidget.replyMatchesNode)},moveFocusUpOrDown:function(a,e,b){var f,h,k;if(b)a=this.matchWidget.getLeftNodeList()[0];else{b=this.matchWidget.getNodeListForItemNode(a);f=b.indexOf(a);k=0===f;k||(h=b[b.length-1],h=l.get(h,"id")===l.get(a,"id"));if("down"===e&&h){this.matchWidget.setLiveRegionMessage(g.sprintf(d.get("QT_LAST_ITEM_STILL_ON_X"),{X:a.innerText}));return}if("up"===e&&k){this.matchWidget.setLiveRegionMessage(g.sprintf(d.get("QT_FIRST_ITEM_STILL_ON_X"),{X:a.innerText}));return}a="down"===e?b[f+1]:b[f-1]}this.matchWidget.moveFocus(a);e=g.sprintf(d.get("QT_X_NOW_FOCUSED"),{X:a.innerText});b=this.matchWidget.getMatchedItemNode(a);null!==b&&(e=g.sprintf(d.get("QT_X_NOW_FOCUSED_ALREADY_MATCHED_TO_Y"),{X:a.innerText,Y:b.innerText}));this.matchWidget.setLiveRegionMessage(e)},handleLeftArrow:function(a){return this.moveFocusLeftOrRight(a,"left")},handleRightArrow:function(a){return this.moveFocusLeftOrRight(a,"right")},moveFocusLeftOrRight:function(a,e){var b,f,h;b=this.matchWidget.getNodeListForItemNode(a);f=b.indexOf(a);h=this.matchWidget.getNodeListPosition(b);"left"===e&&"left"===h||"right"===e&&"right"===h?this.matchWidget.setLiveRegionMessage(g.sprintf(d.get("QT_ALREADY_ON_X_COLUMN_STILL_ON_Y"),{X:e,Y:a.innerText})):(b=this.matchWidget.getOtherNodeList(b),f=b[f],this.matchWidget.moveFocus(f),b=g.sprintf(d.get("QT_X_NOW_FOCUSED"),{X:f.innerText}),h=this.matchWidget.getMatchedItemNode(f),null!==h&&(b=g.sprintf(d.get("QT_X_NOW_FOCUSED_ALREADY_MATCHED_TO_Y"),{X:f.innerText,Y:h.innerText})),this.matchWidget.setLiveRegionMessage(b))},handleEscape:function(){this.matchWidget.setLiveRegionMessage(g.sprintf(d.get("QT_X_HAS_BEEN_UNSELECTED"),{X:this.matchWidget.getSelectedItemNode().innerText}));this.matchWidget.unselect()},handleSpace:function(a){this.handleAction(a)},handleAction:function(a){var e="",b;b=this.matchWidget.getSelectedItemNode();var f,h=this.matchWidget.getNodeListPosition(a);a!==this.matchWidget.replyMatchesNode&&(null!==b?l.get(b,"id")===l.get(a,"id")?e+=g.sprintf(d.get("QT_UNSELECTED_X"),{X:b.innerText}):(f=this.matchWidget.getNodeListForItemNode(b),f=this.matchWidget.getNodeListPosition(f),e="left"===f&&"left"===h||"right"===f&&"right"===h?e+g.sprintf(d.get("QT_UNSELECTED_X_SELECTED_Y"),{X:b.innerText,Y:a.innerText}):e+g.sprintf(d.get("QT_MATCHED_X_WITH_Y"),{X:a.innerText,Y:b.innerText})):(e=g.sprintf(d.get("QT_SELECTED_X"),{X:a.innerText}),b=this.matchWidget.getMatchedItemNode(a),null!==b&&(e=g.sprintf(d.get("QT_SELECTED_X_ALREADY_MATCHED_TO_Y"),{X:a.innerText,Y:b.innerText}))),this.matchWidget.handleSelection(a),e+=g.sprintf(d.get("QT_COMMA_X_NOW_FOCUSED"),{X:a.innerText}),this.matchWidget.setLiveRegionMessage(e))}})})},"url:teststudio/play/widget/MatchTextFeedback.mustache.html":'\x3cdiv class\x3d"screen-readers-only"\x3e\n    {{#displaystudentresult}}\n    \x3ch4\x3e{{headeryourscore}}\x3c/h4\x3e\n    \x3cspan\x3e{{myscore}} {{outof}} {{totalscore}}\x3c/span\x3e\n    {{/displaystudentresult}}\n    \x3ch4\x3e{{headeryouranswers}}\x3c/h4\x3e\n    \x3col\x3e\n        {{#matches}}\n        \x3cli\x3e\x3cspan\x3e{{matchresulttext}}\x3c/span\x3e\x3c/li\x3e\n        {{/matches}}\n    \x3c/ol\x3e\n    {{#displaycorrectanswers}}\n    \x3ch4\x3e{{headercorrectanswers}}\x3c/h4\x3e\n    \x3col\x3e\n        {{#correctmatches}}\n        \x3cli\x3e{{correctmatchtext}}\x3c/li\x3e\n        {{/correctmatches}}\n    \x3c/ol\x3e\n    {{/displaycorrectanswers}}\n\x3c/div\x3e\n',"url:teststudio/play/widget/Match.mustache.html":'\x3cdiv\x3e\n    \x3cdiv data-dojo-attach-point\x3d"textFeedbackPlaceholderNode"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"screenReaderHelpContainer" class\x3d"hidden"\x3e\n        {{#strings}}\n        \x3ca data-dojo-attach-point\x3d"helpLink" class\x3d"screen-reader-help-link" href\x3d"#" title\x3d""\x3e\n            \x3cimg class\x3d"question-mark" src\x3d"{{questionMarkUrl}}" alt\x3d"{{helpLink}}" /\x3e\n        \x3c/a\x3e\n        \x3cdiv data-dojo-attach-point\x3d"helpNode" class\x3d"screen-reader-help-div fui-infobox"\x3e\n            {{{helpText}}}\n            \x3ca data-dojo-attach-point\x3d"closeHelpNode" class\x3d"closeTip" title\x3d"{{close}}" href\x3d"#"\x3ex\x3c/a\x3e\n        \x3c/div\x3e\n        {{/strings}}\n        \x3cdiv class\x3d"screen-readers-only matching-question-feedback" data-dojo-attach-point\x3d"logNode" role\x3d"log" aria-live\x3d"rude"\x3e\x3c/div\x3e\n    \x3c/div\x3e\n    {{#question}}\n    \x3cdiv class\x3d"questions"\x3e\n        \x3cinput data-dojo-attach-point\x3d"questionStateInput" type\x3d"hidden" name\x3d"question_state_{{id}}" id\x3d"question_state_{{id}}"\x3e\n        \x3cdiv class\x3d"wrapper"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"replyMatchesNode" class\x3d"reply-matches" tabindex\x3d"0"\x3e\n                \x3cul class\x3d"match-items-list left-match-items" data-list-position\x3d"left"\x3e\n                    {{#matchItemList1}}\n                        \x3cli class\x3d"match-item" data-item-index\x3d"{{index}}" data-item-id\x3d"{{id}}" id\x3d"{{id}}"\x3e\n                            {{text}}\n                            \x3cinput type\x3d"hidden" name\x3d"match_left_answer_{{id}}" id\x3d"match_left_answer_id_{{id}}"\x3e\n                        \x3c/li\x3e\n                    {{/matchItemList1}}\n                \x3c/ul\x3e\n                \x3cdiv class\x3d"canvasSurface" data-dojo-attach-point\x3d"canvasNode"\x3e\x3c/div\x3e\n                \x3cul class\x3d"match-items-list right-match-items" data-list-position\x3d"right"\x3e\n                    {{#matchItemList2}}\n                        \x3cul class\x3d"right-item"\x3e\n                            \x3cli class\x3d"match-item" \n                                data-item-index\x3d"{{index}}" \n                                data-item-id\x3d"{{id}}" \n                                id\x3d"{{id}}"\x3e{{text}}\x3c/li\x3e\n                        \x3c/ul\x3e\n                    {{/matchItemList2}}\n                \x3c/ul\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"matchingStatusNode" class\x3d"screen-readers-only"\x3e\x3c/div\x3e\n    {{/question}}\n\x3c/div\x3e\n',"url:teststudio/play/widget/MatchCorrectAnswers.mustache.html":'\x3cul class\x3d"left-match-items" data-list-position\x3d"left"\x3e\n    {{#matchItemList1}}\n        \x3cli class\x3d"match-item" data-item-index\x3d"{{index}}"\x3e\n            {{text}}\n        \x3c/li\x3e\n    {{/matchItemList1}}\n\x3c/ul\x3e\n\x3cdiv class\x3d"canvasSurface" data-dojo-attach-point\x3d"correctAnswersCanvasNode"\x3e\x3c/div\x3e\n\x3cul class\x3d"right-match-items" data-list-position\x3d"right"\x3e\n    {{#matchItemList2}}\n        \x3cul class\x3d"right-item"\x3e\x3cli class\x3d"match-item"data-item-index\x3d"{{index}}"\x3e{{text}}\x3c/li\x3e\x3c/ul\x3e\n    {{/matchItemList2}}\n\x3c/ul\x3e\n'}});define("modules/teststudio-play",[],1);